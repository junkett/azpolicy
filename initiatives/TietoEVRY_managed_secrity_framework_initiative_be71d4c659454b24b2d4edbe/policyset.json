{
 "properties": {
  "displayName": "TietoEVRY managed security framework initiative",
  "policyType": "Custom",
  "description": "TietoEVRY Security Framework initiative",
  "metadata": {
   "category": "Security Center",
   "version": "0.9",
   "parameterScopes": {
    "listOfLocations": "/subscriptions/e416f6e4-2850-4d13-88e1-2d6e67461238"
   },
   "createdBy": "53063447-009e-4af4-aaa0-d5de28a071cb",
   "createdOn": "2021-02-16T13:35:27.017007Z",
   "updatedBy": "53063447-009e-4af4-aaa0-d5de28a071cb",
   "updatedOn": "2021-02-16T14:28:43.0431458Z"
  },
  "parameters": {},
  "policyDefinitions": [
   {
    "policyDefinitionReferenceId": "[Preview]: Storage account public access should be disallowed_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4fa4b6c0-31ca-4c0d-b10d-24b96f62a751",
    "parameters": {
     "effect": {
      "value": "deny"
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Secure transfer to storage accounts should be enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9",
    "parameters": {
     "effect": {
      "value": "Deny"
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Activity log should be retained for at least one year_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b02aacc0-b073-424e-8298-42b22829ee0a",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Azure Monitor log profile should collect logs for categories 'write,' 'delete,' and 'action'_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1a4e592a-6a6e-44a5-9814-e36264ca96e7",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Subnets should be associated with a Network Security Group_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e71308d3-144b-4262-b144-efdc3cc90517",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Network Watcher should be enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b6e2945c-0b7b-40f5-9233-7a5323b5cdc6",
    "parameters": {
     "listOfLocations": {
      "value": [
       "westeurope"
      ]
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "SSH access from the Internet should be blocked_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2c89a2e5-7285-40fe-afe0-ae8654b92fab",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "RDP access from the Internet should be blocked_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e372f825-a257-4fb8-9175-797a8a8627d6",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Microsoft IaaSAntimalware extension should be deployed on Windows servers_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9b597639-28e4-48eb-b506-56b05d366257",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Microsoft Antimalware for Azure should be configured to automatically update protection signatures_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c43e4a30-77cb-48ab-a4dd-93f175c63b57",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Advanced data security should be enabled on your SQL servers_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/abfb4388-5bf4-4ad7-ba82-2cd2f41ceae9",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "SQL servers should be configured with 90 days auditing retention or higher._1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/89099bee-89e0-4b26-a5f4-165451757743",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "SQL Auditing settings should have Action-Groups configured to capture critical activities_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7ff426e2-515f-405a-91c8-4f2333442eb5",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Public network access on Azure SQL Database should be disabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1b8ca024-1d5c-4dec-8995-b1a932b41780",
    "parameters": {
     "effect": {
      "value": "Deny"
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Diagnostic logs in Key Vault should be enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21",
    "parameters": {
     "requiredRetentionDays": {
      "value": "365"
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Key vaults should have soft delete enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d",
    "parameters": {
     "effect": {
      "value": "Deny"
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Key vaults should have purge protection enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0b60c0b2-2dc2-4e1c-b5c9-abbed971de53",
    "parameters": {
     "effect": {
      "value": "Deny"
     }
    },
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Vulnerabilities in security configuration on your machines should be remediated_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "System updates should be installed on your machines_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/86b3d65f-7626-441e-b690-81a8b71cff60",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "System updates on virtual machine scale sets should be installed_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c3f317a7-a95c-4547-b7e7-11017ebdf2fe",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Auditing on SQL server should be enabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Management ports of virtual machines should be protected with just-in-time network access control_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b0f33259-77d7-4c9e-aac6-3aabcfae693c",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Subscriptions should have a contact email address for security issues_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4f4f78b8-e367-4b10-a341-d9a4ad5cf1c7",
    "parameters": {},
    "groupNames": []
   }
  ],
  "policyDefinitionGroups": [
   {
    "name": "Storage Accounts",
    "description": "Policies related to storage accounts\nhttps://elo365.sharepoint.com/:x:/r/sites/eloteams_pilvihallinto/Jaetut%20asiakirjat/Desing%20and%20Planning/Design/Deliverable%20documentation%20for%20review/Security%20and%20Compliance%20framework%20policies%20v2.1.xlsx?d=w59b05a6111be4937b663fc6cbba01144&csf=1&web=1&e=wDb4tF"
   },
   {
    "name": "Logging and Monitoring",
    "description": "Policies related to logging and monitoring\nhttps://elo365.sharepoint.com/:x:/r/sites/eloteams_pilvihallinto/Jaetut%20asiakirjat/Desing%20and%20Planning/Design/Deliverable%20documentation%20for%20review/Security%20and%20Compliance%20framework%20policies%20v2.1.xlsx?d=w59b05a6111be4937b663fc6cbba01144&csf=1&web=1&e=wDb4tF\n"
   },
   {
    "name": "Networking",
    "description": "Policies related to networking\nhttps://elo365.sharepoint.com/:x:/r/sites/eloteams_pilvihallinto/Jaetut%20asiakirjat/Desing%20and%20Planning/Design/Deliverable%20documentation%20for%20review/Security%20and%20Compliance%20framework%20policies%20v2.1.xlsx?d=w59b05a6111be4937b663fc6cbba01144&csf=1&web=1&e=wDb4tF"
   },
   {
    "name": "Virtual Machines",
    "description": "Policies related to Virtual Machines\nhttps://elo365.sharepoint.com/:x:/r/sites/eloteams_pilvihallinto/Jaetut%20asiakirjat/Desing%20and%20Planning/Design/Deliverable%20documentation%20for%20review/Security%20and%20Compliance%20framework%20policies%20v2.1.xlsx?d=w59b05a6111be4937b663fc6cbba01144&csf=1&web=1&e=wDb4tF"
   },
   {
    "name": "Database Services",
    "description": "Policies related to Database Services\nhttps://elo365.sharepoint.com/:x:/r/sites/eloteams_pilvihallinto/Jaetut%20asiakirjat/Desing%20and%20Planning/Design/Deliverable%20documentation%20for%20review/Security%20and%20Compliance%20framework%20policies%20v2.1.xlsx?d=w59b05a6111be4937b663fc6cbba01144&csf=1&web=1&e=wDb4tF"
   },
   {
    "name": "Azure Security Center",
    "description": "Policies related to Azure security Center\nhttps://elo365.sharepoint.com/:x:/r/sites/eloteams_pilvihallinto/Jaetut%20asiakirjat/Desing%20and%20Planning/Design/Deliverable%20documentation%20for%20review/Security%20and%20Compliance%20framework%20policies%20v2.1.xlsx?d=w59b05a6111be4937b663fc6cbba01144&csf=1&web=1&e=wDb4tF"
   },
   {
    "name": "Key Management Services",
    "description": "Policies related to Key Management Services"
   }
  ]
 },
 "id": "/subscriptions/e416f6e4-2850-4d13-88e1-2d6e67461238/providers/Microsoft.Authorization/policySetDefinitions/be71d4c659454b24b2d4edbe",
 "type": "Microsoft.Authorization/policySetDefinitions",
 "name": "be71d4c659454b24b2d4edbe"
}
